<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <title>Işığın Tahtı — Tek Dosya</title>
  <meta name="description" content="Işığın Tahtı — Web & Telefon için tek dosya PWA sayfası." />
  <meta name="theme-color" content="#10b981" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <style>
    :root { --emerald:#10b981; --bg:#05070a; --fg:#d9fdf3; }
    * { box-sizing: border-box; }
    html,body { height: 100%; }
    body { margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; background: radial-gradient(1200px 800px at 70% -10%, rgba(16,185,129,.2), transparent), #05070a; color: var(--fg); }
    .container { max-width: 1120px; margin: 0 auto; padding: 24px; }
    .hero { display:grid; gap:24px; align-items:center; grid-template-columns: 1.1fr 0.9fr; }
    @media (max-width: 900px){ .hero { grid-template-columns: 1fr; } }
    .title { font-size: clamp(32px, 5vw, 56px); line-height: 1.04; letter-spacing: .2px; }
    .subtitle { opacity:.9; font-size: clamp(16px, 2.4vw, 18px); }
    .cta { display:flex; gap:12px; flex-wrap:wrap; margin-top: 18px; }
    .btn { padding: 14px 18px; border-radius: 14px; border: 1px solid rgba(255,255,255,.08); background: linear-gradient(180deg, rgba(16,185,129,.22), rgba(16,185,129,.14)); color:#eafff7; text-decoration:none; font-weight:600; backdrop-filter: blur(6px); box-shadow: 0 10px 30px rgba(16,185,129,.18); cursor:pointer; }
    .btn:hover { transform: translateY(-1px); }
    .btn-outline { background: rgba(255,255,255,.02); }
    .card { border:1px solid rgba(255,255,255,.06); background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01)); border-radius: 18px; padding: 16px; }
    .tips { display:grid; gap:12px; grid-template-columns: repeat(3,1fr); margin-top: 28px; }
    @media (max-width: 900px){ .tips { grid-template-columns: 1fr; } }
    .glow { position: relative; }
    .glow::after { content:""; position:absolute; inset: -2px; border-radius: 20px; background: radial-gradient(300px 150px at 10% -20%, rgba(16,185,129,.25), transparent), radial-gradient(400px 200px at 120% 120%, rgba(80,200,250,.15), transparent); z-index:-1; filter: blur(16px); }
    .art { aspect-ratio: 4/3; border-radius: 16px; border:1px solid rgba(255,255,255,.08); background: radial-gradient(120% 140% at 20% 10%, rgba(16,185,129,.35), transparent 40%), radial-gradient(150% 120% at 80% 80%, rgba(250, 204, 21, .25), transparent 45%); box-shadow: 0 20px 60px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.04) inset; display:grid; place-items:center; font-size:18px; }
    footer { opacity:.7; font-size: 13px; margin-top: 28px; }
    /* Play view */
    #playview { display:none; position: fixed; inset:0; background:#0b1324; }
    #unity-canvas { width:100%; height:100%; background:#000; touch-action:none; }
    #loader { position: fixed; inset: 0; display:grid; place-items:center; background: radial-gradient(120% 100% at 50% 20%, rgba(16,185,129,.15), transparent), #0b1324; }
    .bar { width: min(420px, 70vw); height: 8px; border-radius: 999px; background: rgba(255,255,255,.12); overflow:hidden; }
    .bar > i { display:block; height:100%; width:0; background: linear-gradient(90deg, #10b981, #22d3ee); }
    .back { position: fixed; left: 12px; top: 12px; text-decoration:none; color:#bfffea; padding:8px 10px; border:1px solid rgba(255,255,255,.12); border-radius:10px; }
    .warn { position: fixed; right: 12px; top: 12px; font-size: 12px; opacity:.8; }
  </style>
</head>
<body>
  <div class="container" id="home">
    <section class="hero">
      <div>
        <h1 class="title">Işığın Tahtı</h1>
        <p class="subtitle">Melek kanatlarının nuruyla, altın bir tahtın ışığında… Web ve telefonda oynanabilir tek dosya sürüm.</p>
        <div class="cta">
          <button class="btn glow" id="playBtn">▶ Oyna</button>
          <button class="btn btn-outline" id="a2hs">+ Ana Ekrana Ekle</button>
        </div>
        <div class="tips">
          <div class="card"><strong>Tek Dosya</strong><br/>Manifest, ikonlar, service worker bu dosyanın içinde.</div>
          <div class="card"><strong>WebGL</strong><br/>Unity Build dosyalarını ekleyince doğrudan çalışır.</div>
          <div class="card"><strong>Telefon</strong><br/>Ana ekrana ekleyerek PWA gibi kullan.</div>
        </div>
      </div>
      <div class="art" aria-hidden="true">Tek Dosya Kapak</div>
    </section>
    <footer>© Işığın Tahtı — Uzak Mektup & Mira Nova</footer>
  </div>

  <!-- Play View -->
  <div id="playview">
    <a class="back" href="#" id="backBtn">← Geri</a>
    <div id="loader">
      <div>
        <div style="text-align:center; margin-bottom:10px;">Yükleniyor…</div>
        <div class="bar"><i id="p"></i></div>
      </div>
    </div>
    <canvas id="unity-canvas" tabindex="0" role="application" aria-label="Işığın Tahtı"></canvas>
    <div class="warn" id="placeholderWarn" hidden>⚠ Unity WebGL build dosyaları (Build/Build.*) henüz ekli değil. Şimdilik yer tutucu yüklendi.</div>
  </div>

  <script>
    // ------- Inline Manifest via Blob URL -------
    const manifest = {
      name: "Işığın Tahtı",
      short_name: "Işığın Tahtı",
      start_url: "./",
      display: "standalone",
      background_color: "#0b1324",
      theme_color: "#10b981",
      icons: [
        { src: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAYAAABS3GwHAAAFxElEQVR4nO3cPa4UVxRF4fssEBJEDpmQQ6ZD5sAZ0yFkQg6JiHFglWha/bq7/u7ZZ+/1DcBU33NW3bKF/PL23fufAwj1R/UDAJUIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANEIANHeVD+Auw9fP+/+Z/z49OWAJ8EtL/yPsY5xxKKvRRj7EcBGFQv/CEGsRwBPUlz4RwjiMQK4o+PSv4YYbiOAG5wW/xoh/I4ALjgv/jVC+B8BjKzFv5YeQnQAyYt/LTWEyABY/NelhRAVAIv/vJQQIgJg8bdzD8H+L8Ox/Pu4n591AO7Dm8X5HC0/gZwHVs3tk8juBmD5z+V2vlYBuA1HldM5W3wCOQ2km+6fRO1vAJa/Vvfzbx1A98N30XkObQPofOiOus6jZQBdD9tdx7m0C6DjISfpNp9WAXQ73FSd5tQmgE6Husb3v/7+t/oZztBlXi0C6HKYay3LTwR1WgTg6HrpXSNQJx9Ah7fIWq8tu2ME6vOTDkD98LZ4tOREMJdsAMqHttWzy00E88gG4GbtUjtGoEgyANW3xVZbl9ktAsW5ygWgeEh77F1iIjiXVABqh7PXUctLBOeRCsDJ0UvrFoEKmQCU3gp7nbWsThGozFsmABdnL6lTBAokAlB5G+w1azldIlCYu0QADmYvpUsE1coDUHgL7FW1jA4RVM+/PIDuqpew+s/vrjSA6vr3Ulk+lefYqnIPuAE2Uls6tefpoiyAzm9/1WVTfa5nVO0DN8BK6kum/nxqSgLo+vbvslxdnvNaxV5wAzyp21J1e94q0wPo+Pbvukwdn3v2fnADPNBxiS51f/6zEcAdLsvj8jvOMDWATp8/bkvT6ffM3BNugBs6Lcsarr9rDwK44r4k7r9vLQK4kLIcKb/zGdMCUP/+T1sK9d87a1+4AYb+Mpwl9Xdfig8gfQnSf390AOnDXySfw5QAFL//k4d+i+J5zNibyBtAcdgKEs8lLoDEIa+Rdj5RAaQNd6ukc4oJIGmoR0g5r4gAUoZ5tIRzOz2A6v8ClDDEM1Wf39n7Y30DVA/PhfM52gbgPLQKrudpGYDrsKo5nqtdAI5DUuJ2vlYBuA1HldM52wTgNJQOXM7bIgCXYXTjcO7tA3AYQmfdz/9N9QPs9ee3fz5WPwP6an8DAHsQAKIRAKIRAKIRAKIRAKIRAKKdHsCPT1/O/iNg7Oz94QZANAJANAJANAJANAJAtCkB8F+CsMWMveEGQDQCQDQCQLRpAfDvAVhj1r5wAyAaASAaASDa1AD49wA8Y+aecAMgGgEg2vQA+AzCPbP3gxsA0UoC4BbALRV7wQ2AaGUBcAvgUtU+cAMgWmkA3AIYo3YPuAEQrTwAboFs1fMvDwCoJBFA9VsANRTmLhEAUEUmAIW3AeZRmbdMAEAFqQBU3go4l9KcpQIYQ+twcDy1+coFMIbeIeEYinOVDACYRTYAxbcFtlOdp2wAY+geGtZRnqN0AGNoHx4eU5+ffADAmVoEoP4WwW0d5tYigDF6HCZ+6TKvNgGM0edQ03WaU6sAxuh1uIm6zaddAGP0O+QUHefSMoAxeh62s67zaBvAGH0P3U3nObQOYIzeh++g+/m/vH33/mf1Qxzlw9fP1Y8Qo/viL9rfAJdchqLO6ZytAhjDaziK3M7X6hPoGp9Ex3Fb/IXdDXDJdWizOZ+jdQBjeA9vBvfzs/4EusYn0fPcF38RFcCCEF6XsviLyAAWhPBL2uIvogNYJIeQuvgLAriQFEL64i8I4AbnEFj83xHAHU4hsPi3EcCTOsbA0j9GABspBsHCr0cAB6kIgoXfjwBOdkQYLPp5CADR7P8yHHAPASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASAaASDaf33wHJMxJkOTAAAAAElFTkSuQmCC", sizes: "192x192", type: "image/png" },
        { src: "data:image/png;base64,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", sizes: "512x512", type: "image/png" }
      ]
    };
    const manifestBlob = new Blob([JSON.stringify(manifest)], {type: 'application/manifest+json'});
    const manifestURL = URL.createObjectURL(manifestBlob);
    const link = document.createElement('link');
    link.rel = 'manifest';
    link.href = manifestURL;
    document.head.appendChild(link);

    // Apple touch icon (best effort)
    const touchIcon = document.createElement('link');
    touchIcon.rel = 'apple-touch-icon';
    touchIcon.href = "data:image/png;base64,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";
    document.head.appendChild(touchIcon);

    // ------- Inline Service Worker via Blob URL -------
    const swCode = [
      "const CACHE='isigintahti-single-v1';",
      "self.addEventListener('install',e=>{self.skipWaiting();});",
      "self.addEventListener('activate',e=>{self.clients.claim();});",
      "self.addEventListener('fetch',e=>{})"
    ].join("\n");
    if ('serviceWorker' in navigator) {
      const swBlob = new Blob([swCode], {type: 'text/javascript'});
      const swURL = URL.createObjectURL(swBlob);
      window.addEventListener('load', () => navigator.serviceWorker.register(swURL));
    }

    // ------- Add to Home Screen -------
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      const btn = document.getElementById('a2hs');
      btn.style.display = 'inline-flex';
      btn.addEventListener('click', async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        await deferredPrompt.userChoice;
        deferredPrompt = null;
      });
    });

    // ------- Play View Logic -------
    const home = document.getElementById('home');
    const playview = document.getElementById('playview');
    document.getElementById('playBtn').addEventListener('click', () => {
      home.style.display = 'none';
      playview.style.display = 'block';
      bootUnity();
    });
    document.getElementById('backBtn').addEventListener('click', (e) => {
      e.preventDefault();
      playview.style.display = 'none';
      home.style.display = 'block';
    });

    function resumeAudio() {
      const AC = window.AudioContext || window.webkitAudioContext; 
      if (AC) {
        const a = new AC();
        if (a.state === 'suspended') a.resume();
      }
      window.removeEventListener('touchend', resumeAudio);
      window.removeEventListener('click', resumeAudio);
    }
    window.addEventListener('touchend', resumeAudio);
    window.addEventListener('click', resumeAudio);

    // Try to load Unity loader; if not present, show placeholder
    function bootUnity() {
      const buildUrl = "./Build";
      const loaderUrl = buildUrl + "/Build.loader.js";
      const config = {
        dataUrl: buildUrl + "/Build.data",
        frameworkUrl: buildUrl + "/Build.framework.js",
        codeUrl: buildUrl + "/Build.wasm",
        streamingAssetsUrl: "streamingassets",
        companyName: "Uzak Mektup",
        productName: "Işığın Tahtı",
        productVersion: "1.0.0"
      };
      const canvas = document.getElementById("unity-canvas");
      const progressEl = document.getElementById("p");

      const script = document.createElement('script');
      script.src = loaderUrl;
      script.onload = () => {
        if (typeof createUnityInstance !== 'function') { showPlaceholder(); return; }
        createUnityInstance(canvas, config, (progress) => {
          progressEl.style.width = (progress*100).toFixed(0) + '%';
        }).then(() => {
          document.getElementById('loader').style.display = 'none';
        }).catch((message) => {
          alert(message);
        });
      };
      script.onerror = () => showPlaceholder();
      document.body.appendChild(script);
    }

    function showPlaceholder() {
      document.getElementById('loader').style.display = 'none';
      document.getElementById('placeholderWarn').hidden = false;
      const canvas = document.getElementById("unity-canvas");
      const ctx = canvas.getContext('2d');
      const w = canvas.width = window.innerWidth;
      const h = canvas.height = window.innerHeight;
      ctx.fillStyle = '#000';
      ctx.fillRect(0,0,w,h);
      ctx.fillStyle = '#bfffea';
      ctx.font = '20px system-ui, -apple-system, Segoe UI, Roboto, Arial';
      ctx.fillText('Işığın Tahtı', 24, 48);
      ctx.font = '14px system-ui';
      ctx.fillText('Unity WebGL build eklenince oyun burada çalışacak.', 24, 72);
    }
  </script>
</body>
</html>
